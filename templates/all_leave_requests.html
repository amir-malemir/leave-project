{% extends "base.html" %}

{% block title %}Ú©Ù„ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ù‡Ø§{% endblock %}
{% block content %}
    <div class="content">
        <h1 class="text-center my-4">Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ù‡Ø§ÛŒ Ù…Ø±Ø®ØµÛŒ</h1>
        <div class="row justify-content-center">
            <div class="col-12">
                <div class="table-responsive table-container overflow-auto">
                    <table class="table table-striped table-hover align-middle text-center">
                        <thead class="table-dark">
                            <tr>
                                <th class="text-nowrap">Ø´Ù†Ø§Ø³Ù‡</th>
                                <th class="text-nowrap">Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¯Ù‡Ù†Ø¯Ù‡</th>
                                <th class="text-nowrap">Ø´Ø±ÙˆØ¹</th>
                                <th class="text-nowrap">Ù¾Ø§ÛŒØ§Ù†</th>
                                <th class="text-nowrap">ÙˆØ¶Ø¹ÛŒØª</th>
                                <th class="text-nowrap">Ø¯Ù„ÛŒÙ„</th>
                                <th class="text-nowrap">Ø¹Ù…Ù„ÛŒØ§Øª</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for req in leave_requests %}
                            <tr>
                                <td>{{ req.id }}</td>
                                <td>{{ req.user.full_name }}</td>
                                <td>{{ req.start_date_shamsi }}</td>
                                <td>{{ req.end_date_shamsi }}</td>
                                <td>
                                    <span class="badge 
                                        {% if req.status == 'approved' %}bg-success
                                        {% elif req.status == 'rejected' %}bg-danger
                                        {% else %}bg-warning text-dark{% endif %}">
                                        {{ req.status | fa_status(req.user.team, req.tornado_approval, req.zitel_approval) }}
                                    </span>
                                </td>
                                <td>{{ req.reason or '-' }}</td>
                                <td>
                                    {% if current_user.role in ['admin', 'supervisor', 'manager'] or
                                        (current_user.role == 'team_lead' and (
                                            current_user.team == req.user.team or
                                            (req.user.team == 'Tornado' and current_user.team == 'Zitel')
                                        )) %}
                                        <a href="/edit-leave-request/{{ req.id }}" class="btn btn-sm btn-warning">
                                            ÙˆÛŒØ±Ø§ÛŒØ´
                                        </a>
                                    {% endif %}
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                        <button id="export-excel-btn" class="btn btn-success">ðŸ“¥ Ø®Ø±ÙˆØ¬ÛŒ Ø§Ú©Ø³Ù„</button>
                    </table>
                    


                </div>
            </div>
        </div>
    </div>

{% endblock %}